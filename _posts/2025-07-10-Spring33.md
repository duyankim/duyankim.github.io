---
layout: post
author: "Yan"
catalog: true
subtitle: "Logger? Logback? Slf4j?"
header-img: "img/header/spring.jpg"
title: "Logging Deep Dive"
date: 2025-07-10 11:40:08 +0000
categories:
  - Spring
tags:
  - Spring
comments: true
---

# 스프링에서 로깅이란

- 스프링은 원래 JCL `Jakarta  Commons Logging`을 사용해서 로깅을 했다고 한다.

## JCL (commons-logging)

- JCL은 로깅 라이브러리가 아니라 로깅 추상화 라이브러리인데, 로깅 라이브러리의 선택권은 애플리케이션 개발자에게 있다.
- 라이브러리나 프레임워크는 주로 로깅 추상화 라이브러리를 사용한다.
- JCL의 로깅 구현체를 찾는 방법은, 
  - 설정 파일에서 찾고
  - 애플리케이션 클래스패스에서 Log4j구현체를 찾아보고
  - 애플리케이션이 JDK 1.4에서 구동중인지 확인하고
  - 아무것도 못 찾으면 기본 구현체를 사용한다.

### JCL의 문제점

- JCL이 구현체를 선택하는 시점이 **런타임**이라 클래스 로더에 의존적이다.
- 따라서 가비지 컬렉션이 제대로 작동하지 않는 치명적인 문제점이 있다.
- 문제 해결을 위해 클래스 로더 대신에 **컴파일 시점**에 구현체를 선택하도록 변경하면서 도입된 것이 **SLF4J**이다.

## [SLF4J](https://www.slf4j.org/manual.html) (Simple Logging Facade For Java)

> Facade란? 복잡한 시스템을 감추고 단순한 인터페이스 하나로 제공하는 방식.  
> 여러 로깅 구현체들의 복잡한 구조를 가려주고 공통된 껍데기만 보여주기 때문에 Simple Logging Facade인 것!  

- SLF4J는 라이브러리 인터페이스 역할이고, **Logback**이 실질적인 로깅 라이브러리 구현체다.
  - 각각 다른 로깅 라이브러리를 사용한 라이브러리들을 통합해서 로깅을 하고 싶은 목적에서 SLF4J를 사용해 인터페이스는 통일하되, 구현체를 갈아끼우는 형태인 것이다.
- 로깅 구현체를 런타임이 아닌 **컴파일 타임**에 정한다.
- 세가지 모듈 Bridging, API, Binding을 제공한다.
- SLF4J는 클래스 별로 Logger를 사용한다.

## [Logback](https://logback.qos.ch/manual/architecture.html)

### 로그를 구성하는 3요소 Logger, Appenders, Layouts

- Logger는 로그를 만들어주는 요소
  - Logger = logback-classic module
- Appender는 로그를 어디에 보낼지 결정하는 요소 => 여러 appender를 동시에 등록 가능
- Layout은 보내기 전에 어떻게 형식으로 로깅할지 결정하는 요소
  - Appender, Layout = logback-core

#### Logger

모든 로거는 원하는 로거를 매개변수로 입력받아서 LoggerFactory를 이용해 생성한다.

```java
Logger rootLogger = LoggerFactory.​getLogger(org.slf4j.Logger.​ROOT_LOGGER_NAME);
```

로거는 아래와 같은 레벨로 사용할 수 있으며, default는 DEBUG이다.

```java
package org.slf4j; 
public interface Logger {

  // Printing methods: 
  public void trace(String message);
  public void debug(String message);
  public void info(String message); 
  public void warn(String message); 
  public void error(String message); 
}
```

log의 적용 규칙은 아래와 같다.

> TRACE < DEBUG < INFO <  WARN < ERRORㄴ

##### LoggerContext

로깅 시스템의 전체 설정과 Logger 인스턴스를 관리하는 컨테이너이자 중심 객체

- 모든 Logger와 Appender, Layout, 설정 상태를 담고 관리하는 중앙 컨트롤러
- 로거 등록, 설정 로딩, Appender 연결, 로깅 트리 계층 관리 등 전반적인 상태 및 생명주기 관리

- 내부적으로 LoggerContext를 통해 Logback을 제어하지만, 개발자는 보통 application.yml이나 logback-spring.xml만 수정하면 된다.

#### Appender

로그 메세지를 받아서 콘솔, 파일, DB, 원격서버 등 원하는 곳으로 출력하는 역할이다.

```
[Logger] → [Appender] → 출력 대상(Console, File, Socket, DB 등)
                   ↘ [Layout] 포맷 설정
```

