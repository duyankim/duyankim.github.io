---
layout: post
author: "Yan"
catalog: true
subtitle: "분산락 파헤치기"
header-img: "img/header/spring.jpg"
title: "동시성을 제어하는 방법 - 분산락"
date: 2025-02-25 11:40:08 +0000
categories:
  - Spring
tags:
  - Spring
  - Lock
comments: true
---

# 분산 락 (Distributed Lock)

자바, 스프링 기반의 웹 애플리케이션은 기본적으로 멀티 스레드 환경에서 구동이 되는데,  
여러 스레드가 함께 접근할 수 있는 공유 자원에 대해 Race Condition(여러 스레드가 동시에 하나의 공유 자원에 접근할 때 발생하는 문제)이 발생하지 않도록 별도의 처리가 필요하다.  

자바의 `synchronized`, `ReentrantLock`, `AtomicInteger` 같은 자바 내부의 Lock 방식이 있지만, 이것들은  같은 프로세스(JVM) 내에서만 **상호 배제(Mutual Exclusion)**가 보장된다.  
멀티 인스턴스 환경(예: 여러 서버에 동일한 애플리케이션을 띄운 상황)에서는 서버마다 각각의 JVM 메모리를 사용하므로, 위 방식으로는 여러 서버에서 공유할 수 있는 Lock을 잡을 수 없다.  

이럴 때 분산락이 필요하다.  

분산 락을 구현하기 위해 락에 대한 정보를 공통된 저장소에 보관하고 있어야 한다. 그리고 분산 환경에서 여러 대의 서버들은 Lock 상태를 서버들끼리 공유하고, 임계영역(Critical Section)에 접근할 수 있는지 확인할 수 있어야 한다.  

이 원자성을 보장하는 분산환경의 공통된 저장소에 필요한 조건은 아래와 같다.  

- 공통된 저장소로서 Lock 상태를 모든 서버가 공유할 수 있게 한다.
- Race Condition 방지: 여러 서버가 동시에 같은 자원에 접근하지 않도록 Mutex 역할을 한다.
- 분산 환경에서도 데이터 일관성을 유지하도록 Lock 관리를 담당한다.
- **SPOF(Single Point of Failure)**가 생기지 않도록 고가용성 및 Failover를 지원한다.

## 여러 서버에서 공유할 수 있는 Lock 저장소들

> Redisson, Zookeeper에 관한 이야기 TO BE CONTINUED..
