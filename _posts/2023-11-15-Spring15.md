---
layout: post
author: "Yan"
catalog: true
subtitle: "Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ObjectMapper"
header-img: "img/header/spring.jpg"
title: "Spring - HttpMessageConverter, ObjectMapper"
date: 2023-11-15 11:40:08 +0000
categories:
  - Spring
tags:
  - Spring
  - TDD
  - ObjectMapper
comments: true
---

## ObjectMapperëž€?

- JSON ì»¨í…ì¸ ë¥¼ Java ê°ì²´ë¡œ deserialization í•˜ê±°ë‚˜ Java ê°ì²´ë¥¼ JSONìœ¼ë¡œ serialization í•  ë•Œ ì‚¬ìš©í•˜ëŠ” Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í´ëž˜ìŠ¤ì´ë‹¤.
- ObjectMapperëŠ” ìƒì„± ë¹„ìš©ì´ ë¹„ì‹¸ê¸° ë•Œë¬¸ì— bean/staticìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

### Java ê°ì²´ë¥¼ Jsonìœ¼ë¡œ

```java
public class Car {

    private String color;
    private String type;

    // standard getters setters
}

ObjectMapper objectMapper = new ObjectMapper();
Car car = new Car("yellow", "renault");
objectMapper.writeValue(new File("target/car.json"), car);
```

ê²°ê³¼ê°’

```json
{"color":"yellow","type":"renault"}
```

##### `writeValueAsString` 

- ìžë°”ê°ì²´ì—ì„œ string Json ë°˜í™˜

##### `writeValueAsBytes` 

- ìžë°”ê°ì²´ì—ì„œ bytes Json ë°˜í™˜


### Jsonì„ ìžë°” ê°ì²´ë¡œ

```java
String json = "{ \"color\" : \"Black\", \"type\" : \"BMW\" }";
Car car = objectMapper.readValue(json, Car.class);	

Car car = objectMapper.readValue(new File("src/test/resources/json_car.json"), Car.class);
// ë˜ëŠ” urlì‚¬ìš©

Car car = objectMapper.readValue(new URL("file:src/test/resources/json_car.json"), Car.class);
```


## Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ëž€?

Jacksonì€ JSON ë°ì´í„° êµ¬ì¡°ë¥¼ ì²˜ë¦¬í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

### ìž‘ë™ ë°©ì‹

-  Jacksonì€ JSONë°ì´í„°ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•œ  `MappingJacksonHttpMessageConverterë¥¼` ì œê³µí•œë‹¤. 
- ë§Œì•½ ìŠ¤í”„ë§ `MessageConverter`ë¥¼ ìœ„ì˜ `MappingJacksonHttpMessageConverter`ìœ¼ë¡œ ë“±ë¡í•œë‹¤ë©´, ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë¦¬í„´í•˜ëŠ” ê°ì²´ë¥¼ ë‹¤ì‹œ ëœ¯ì–´(ìžë°” ë¦¬í”Œë ‰ì…˜ ì‚¬ìš©), Jacksonì˜ `ObjectMapper` APIë¡œ JSON ê°ì²´ë¥¼ ë§Œë“¤ê³  ë‚œ í›„, ì¶œë ¥í•˜ì—¬ JSONë°ì´í„°ë¥¼ ì™„ì„±í•œë‹¤.
- Spring 3.1 ì´í›„ë¡œ ë§Œì•½ í´ëž˜ìŠ¤íŒ¨ìŠ¤ì— Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¡´ìž¬í•œë‹¤ë©´, ìžë™ì ìœ¼ë¡œ `MessageConverter`ê°€ ë“±ë¡ëœë‹¤.

### ê¸°ë³¸ ë™ìž‘ ì›ë¦¬

- Jacksonì€ ê¸°ë³¸ì ìœ¼ë¡œ í”„ë¡œí¼í‹°ë¡œ ë™ìž‘í•œë‹¤. 
- JavaëŠ” í”„ë¡œí¼í‹°ë¥¼ ì œê³µí•˜ëŠ” ë¬¸ë²•ì´ ì—†ìŠµë‹ˆë‹¤. (ë©¤ë²„ë³€ìˆ˜ëž‘ì€ ë‹¤ë¦„)
- Javaì˜ í”„ë¡œí¼í‹°ëŠ” ë³´í†µ Getter ì™€ Setterì˜ ì´ë¦„ ëª…ëª… ê·œì¹™ìœ¼ë¡œ ì •í•´ì§„ë‹¤.
- í”„ë¡œí¼í‹°ëŠ” Getter, Setterê¸°ì¤€ì´ë¯€ë¡œ ë©¤ë²„ë³€ìˆ˜ ì´ë¦„ì„ ë³€ê²½í•˜ë”ë¼ë„ ìƒê´€ ì—†ë‹¤. 
- ë§Žì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•´ë‹¹ í”„ë¡œí¼í‹° ê°œë…ìœ¼ë¡œ ìž‘ë™í•œë‹¤.
- JSONë°ì´í„°ë¡œ ì¶œë ¥ë˜ê¸° ìœ„í•´ì„œëŠ” ë©¤ë²„ë³€ìˆ˜ì˜ ìœ ë¬´ê°€ ì•„ë‹Œ í”„ë¡œí¼í‹° ì¦‰, Getter, Setterë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìž‘ë™í•œë‹¤.

## HttpMessageConverter

![](https://velog.velcdn.com/images/rlfrkdms1/post/b73733e7-0659-4640-a787-744cdec02005/image.png)

#### `@ResponseBody` ì‚¬ìš© ì›ë¦¬

- HTTP Bodyì— ë¬¸ìž ë‚´ìš©ì„ ì§ì ‘ ë°˜í™˜
- `viewResolver` ëŒ€ì‹ ì— `HttpMessageConverter`ê°€ ë™ìž‘í•¨
- ê¸°ë³¸ ë¬¸ìžì²˜ë¦¬ : `StringHttpMessageConverter`
- ê¸°ë³¸ ê°ì²´ì²˜ë¦¬ : `MappingJackson2HttpMessageConverter`
- byteì²˜ë¦¬ ë“±ë“± ê¸°íƒ€ ì—¬ëŸ¬ `HttpMessageConverter`ê°€ ê¸°ë³¸ìœ¼ë¡œ ë“±ë¡ë˜ì–´ ìžˆìŒ

> ì‘ë‹µì˜ ê²½ìš° í´ë¼ì´ì–¸íŠ¸ì˜ HTTP Accept í—¤ë”ì™€ ì„œë²„ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ë°˜í™˜ íƒ€ìž… ì •ë³´ ë“±ì„ ì¡°í•©í•´ì„œ `HttpMessageConverter`ê°€ ì„ íƒëœë‹¤.

### MessageConverter

- HTTP ë©”ì„¸ì§€ ì»¨ë²„í„°ëŠ” HTTPìš”ì²­, HTTPì‘ë‹µ(ë©”ì„¸ì§€ ë°”ë””ë¥¼ ê°ì²´ë¡œ ë°”ê¿”ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì— íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ì£¼ëŠ” ì¼) ë‘˜ ë‹¤ ì‚¬ìš©í•œë‹¤.

- `read`, `write` : ë©”ì„¸ì§€ ì»¨ë²„í„°ë¥¼ í†µí•´ì„œ ë©”ì„¸ì§€ë¥¼ ì½ê³  ì“°ëŠ” ê¸°ëŠ¥

- ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ë‹¤ì–‘í•œ ë©”ì„¸ì§€ ì»¨ë²„í„°ëŠ”, ëŒ€ìƒ í´ëž˜ìŠ¤ì˜ íƒ€ìž…ê³¼ ë¯¸ë””ì–´ íƒ€ìž… ë‘˜ ë‹¤ ì²´í¬í•´ì„œ ì‚¬ìš©ì—¬ë¶€ë¥¼ ê²°ì •í•œë‹¤.

1. `ByteArrayHttpMessageConverter` : `byte[]` ë°ì´í„°ë¥¼ ì²˜ë¦¬
  - í´ëž˜ìŠ¤íƒ€ìž… : `byte[]`
  - ë¯¸ë””ì–´íƒ€ìž… : `*/*`

2. `StringHttpMessageConverter` : `String` ë¬¸ìžë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬
  - í´ëž˜ìŠ¤íƒ€ìž… : `String`
  - ë¯¸ë””ì–´íƒ€ìž… : `*/*`

3. `MappingJackson2HttpMessageConverter` : application/jsonì²˜ë¦¬
  - í´ëž˜ìŠ¤íƒ€ìž… : `HashMap`
  - ë¯¸ë””ì–´íƒ€ìž… : `application/jsonê´€ë ¨`


#### ìŠ¤í”„ë§ MVCê°€ HTTP ë©”ì‹œì§€ ì»¨ë²„í„°ë¥¼ ì ìš©í•˜ëŠ” ê²½ìš°

- HTTP ìš”ì²­: `@RequestBody`, `HttpEntity(RequestEntity)`

- HTTP ì‘ë‹µ; `@ResponseBody`, `HttpEntity(ResponseEntity)`


#### ðŸ‘ˆ HTTP ìš”ì²­ ë°ì´í„° ì½ê¸° ë™ìž‘ ì›ë¦¬

1. HTTP ìš”ì²­ì´ ì˜¤ê³ , ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ `@RequestBody`, `HttpEntity` íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•œë‹¤.

2. ë©”ì„¸ì§€ ì»¨ë²„í„°ê°€ ë©”ì„¸ì§€ë¥¼ ì½ì„ ìˆ˜ ìžˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ `canRead()`ë¥¼ í˜¸ì¶œí•œë‹¤.
  - ëŒ€ìƒ í´ëž˜ìŠ¤ íƒ€ìž…ì„ ì§€ì›í•˜ëŠ”ì§€ ì²´í¬ (`byte[]`, `String` ë“±)
  - HTTP ìš”ì²­ì˜ Content-Type ë¯¸ë””ì–´ íƒ€ìž…ì„ ì§€ì›í•˜ëŠ”ì§€ ì²´í¬ (`text/plain`, `application/json`, `*/*`)

3. `canRead()`ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ `read()`ë¥¼ í˜¸ì¶œí•´ì„œ ê°ì²´ ìƒì„±í•˜ê³ , ë°˜í™˜í•œë‹¤.

#### ðŸ‘‰ HTTP ì‘ë‹µ ë°ì´í„° ì½ê¸° ë™ìž‘ ì›ë¦¬

1. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ `@ResonseBody`, `HttpEntity` ë¡œ ê°’ì´ ë°˜í™˜ëœë‹¤.

2. ë©”ì„¸ì§€ ì»¨ë²„í„°ê°€ ë©”ì„¸ì§€ë¥¼ ì“¸ ìˆ˜ ìžˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ `canWrite()`ë¥¼ í˜¸ì¶œí•œë‹¤.
  - ëŒ€ìƒ í´ëž˜ìŠ¤ íƒ€ìž…ì„ ì§€ì›í•˜ëŠ”ì§€ ì²´í¬ (`byte[]`, `String` ë“±)
  - HTTP ìš”ì²­ì˜ Accept ë¯¸ë””ì–´ íƒ€ìž…ì„ ì§€ì›í•˜ëŠ”ì§€ ì²´í¬ (`text/plain`, `application/json`, `*/*`)

3. `canWrite()`ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ `write()`ë¥¼ í˜¸ì¶œí•´ì„œ HTTPì‘ë‹µ ë©”ì„¸ì§€ ë°”ë””ì— ë°ì´í„°ë¥¼ ìƒì„±í•œë‹¤.




###### reference

> [Intro to the Jackson ObjectMapper](https://www.baeldung.com/jackson-object-mapper-tutorial)
> [[Java] ObjectMapperë¥¼ ì´ìš©í•˜ì—¬ JSON íŒŒì‹±í•˜ê¸°](https://velog.io/@zooneon/Java-ObjectMapper%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-JSON-%ED%8C%8C%EC%8B%B1%ED%95%98%EA%B8%B0)    
> [[Spring] Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´í•´í•˜ê¸°.](https://mommoo.tistory.com/83)  
> [ìŠ¤í”„ë§ MVC 1íŽ¸ - ë°±ì—”ë“œ ì›¹ ê°œë°œ í•µì‹¬ ê¸°ìˆ ](https://inf.run/Gmptq)
> [Spring MVC - Message Converter](https://velog.io/@rlfrkdms1/Spring-MVC-Message-Converter)